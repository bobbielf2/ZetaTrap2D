function cd = CDF2(k)
% central difference coefficients for the 2nd derivative
% Input:
%   k: integer, such that 2k+1 points about the center are used, order of
%      accuracy is 2k
% Output:
%   cd: central difference coefficients at nodes 0:k
%       (coefficients at nodes 0:-1:-k are the same)

if k <= 21
    cd = precom_coeffs(k);
else
    x = sym(0:k);               % half of the -n:n grid
    A=2*x.^((0:2:2*k)'); A(1)=1;% even moments Vandermonde, times 2 bc symmetry
    b = zeros(k+1,1); b(2) = 2; % rhs: 2nd deriv of monomials eval at 0
    cd = double(A\b);          	% sym central diff coeffs at 0, +/-1, +/-2, ...
end
cd = cd'; % row vector

function c = precom_coeffs(k)
% precomputed coeffs
switch k
    case 0
        c = 0;
    case 1
        c = [-2;1];
    case 2
        c = [-30;16;-1]/12;
    case 3
        c = [-490;270;-27;2]/180;
    case 4
        c = [-2.847222222222222e+00
            1.600000000000000e+00
            -2.000000000000000e-01
            2.539682539682540e-02
            -1.785714285714286e-03];
    case 5
        c = [-2.927222222222222e+00
            1.666666666666667e+00
            -2.380952380952381e-01
            3.968253968253968e-02
            -4.960317460317460e-03
            3.174603174603175e-04];
    case 6
        c = [-2.982777777777778e+00
            1.714285714285714e+00
            -2.678571428571428e-01
            5.291005291005291e-02
            -8.928571428571428e-03
            1.038961038961039e-03
            -6.012506012506013e-05];
    case 7
        c = [-3.023594104308390e+00
            1.750000000000000e+00
            -2.916666666666667e-01
            6.481481481481481e-02
            -1.325757575757576e-02
            2.121212121212121e-03
            -2.266252266252266e-04
            1.189286903572618e-05];
    case 8
        c = [-3.054844104308390e+00
            1.777777777777778e+00
            -3.111111111111111e-01
            7.542087542087542e-02
            -1.767676767676768e-02
            3.480963480963481e-03
            -5.180005180005180e-04
            5.074290788576503e-05
            -2.428127428127428e-06];
    case 9
        c = [-3.079535462333082e+00
            1.800000000000000e+00
            -3.272727272727273e-01
            8.484848484848485e-02
            -2.202797202797203e-02
            5.034965034965035e-03
            -9.324009324009324e-04
            1.284429855858427e-04
            -1.156931303990128e-05
            5.078436450985471e-07];
    case 10
        c = [-3.099535462333082e+00
            1.818181818181818e+00
            -3.409090909090909e-01
            9.324009324009325e-02
            -2.622377622377622e-02
            6.713286713286713e-03
            -1.456876456876457e-03
            2.518489913447897e-04
            -3.213698066639243e-05
            2.672861289992353e-06
            -1.082508822446903e-07];
    case 11
        c = [-3.116064387952916e+00
            1.833333333333333e+00
            -3.525641025641026e-01
            1.007326007326007e-01
            -3.021978021978022e-02
            8.461538461538461e-03
            -2.073906485671192e-03
            4.232462215655493e-04
            -6.822060808128920e-05
            8.085405402226867e-06
            -6.237312738860727e-07
            2.343092689279011e-08];
    case 12
        c = [-3.129953276841805e+00
            1.846153846153846e+00
            -3.626373626373626e-01
            1.074481074481075e-01
            -3.399725274725274e-02
            1.023917259211377e-02
            -2.765208647561589e-03
            6.415521674256748e-04
            -1.227970945463205e-04
            1.848092663366141e-05
            -2.041302350899874e-06
            1.466979770679033e-07
            -5.136127090629716e-09];
    case 13
        c = [-3.141787596368432e+00
            1.857142857142857e+00
            -3.714285714285714e-01
            1.134920634920635e-01
            -3.755252100840336e-02
            1.201680672268907e-02
            -3.513686176224876e-03
            9.035193024578253e-04
            -1.976448474126493e-04
            3.549177955782703e-05
            -4.999711555102590e-06
            5.164991275932428e-07
            -3.472021913265688e-08
            1.137849693924122e-09];
    case 14
        c = [-3.151991678001085e+00
            1.866666666666667e+00
            -3.791666666666667e-01
            1.189542483660131e-01
            -4.089052287581699e-02
            1.377364981080151e-02
            -4.304265565875473e-03
            1.204692403277100e-03
            -2.934726522187823e-04
            6.049033733333998e-05
            -1.020774442500112e-05
            1.349784386777008e-06
            -1.308685182692451e-07
            8.259945926263994e-09
            -2.543605797264240e-10];
    case 15
        c = [-3.1608805668899742E+00
            1.8750000000000000E+00
            -3.8602941176470590E-01
            1.2391067538126362E-01
            -4.4020897832817339E-02
            1.5495356037151704E-02
            -5.1241256736612771E-03
            1.5400897200985658E-03
            -4.1013258850450935E-04
            9.4516152083343722E-05
            -1.8373939965002018E-05
            2.9202066060079494E-06
            -3.6352366185901429E-07
            3.3187282739453544E-08
            -1.9734872564981174E-09
            5.7304222559056440E-11];
    case 16
        c = [-3.1686930668899742E+00
            1.8823529411764706E+00
            -3.9215686274509803E-01
            1.2842563926155257E-01
            -4.6955624355005159E-02
            1.7172342621259030E-02
            -5.9626189657149406E-03
            1.9046520209914629E-03
            -5.4684345133934576E-04
            1.3826362819049139E-04
            -3.0152106609234084E-05
            5.5375769713928528E-06
            -8.3091122710631844E-07
            9.7654533118392042E-08
            -8.4202122943919670E-09
            4.7322196693930480E-10
            -1.2997429511882761E-11];
    case 17
        c = [-3.175613482114888e+00
            1.888888888888889e+00
            -3.976608187134503e-01
            1.325536062378168e-01
            -4.970760233918128e-02
            1.879851143009038e-02
            -6.811054865974774e-03
            2.293518475277220e-03
            -7.023900330536486e-04
            1.921066757069808e-04
            -4.610560216967540e-05
            9.525950861503180e-06
            -1.656092031956731e-06
            2.351846672601275e-07
            -2.616603605461590e-08
            2.136892944460298e-09
            -1.138259736040642e-10
            2.965545414475924e-12];
    case 18
        c = [-3.181786321621061e+00
            1.894736842105263e+00
            -4.026315789473684e-01
            1.363408521303258e-01
            -5.228981544771018e-02
            2.037029332223840e-02
            -7.662436724221621e-03
            2.702181767235707e-03
            -8.752860411899313e-04
            2.561422342759744e-04
            -6.668846028113762e-05
            1.520398068535483e-05
            -2.980965657522116e-06
            4.916118205953633e-07
            -6.623277876324650e-08
            6.993467818233704e-09
            -5.423472859958352e-10
            2.745247755114856e-11
            -6.801925593520176e-13];
    case 19
        c = [-3.187326487826047e+00
            1.900000000000000e+00
            -4.071428571428571e-01
            1.398268398268398e-01
            -5.471485036702428e-02
            2.188594014680971e-02
            -8.511198945981555e-03
            3.126562878115673e-03
            -1.063899868247694e-03
            3.302405234772384e-04
            -9.223959448847006e-05
            2.286932094755456e-05
            -4.959117983251078e-06
            9.243326418485737e-07
            -1.449092917183756e-07
            1.856354325281152e-08
            -1.864641621376157e-09
            1.376436721661754e-10
            -6.636473349353468e-12
            1.567442313158276e-13];
    case 20
        c = [-3.192326487826047e+00
            1.904761904761905e+00
            -4.112554112554113e-01
            1.430453604366648e-01
            -5.699463579898362e-02
            2.334500282326369e-02
            -9.352965874705006e-03
            3.563034618935240e-03
            -1.266547462199636e-03
            4.140947002849385e-04
            -1.229861259846267e-04
            3.278755691405672e-05
            -7.748621848829809e-06
            1.600576003200993e-06
            -2.841358661144621e-07
            4.243095600642634e-08
            -5.179560059378215e-09
            4.960132330312626e-10
            -3.492880710186036e-11
            1.607633141700796e-12
            -3.627222275962422e-14];
    case 21
        c = [-3.196861635218337e+00
            1.909090909090909e+00
            -4.150197628458498e-01
            1.460254721124286e-01
            -5.914031620553360e-02
            2.474794770446944e-02
            -1.018434061912323e-02
            4.008413946302145e-03
            -1.481558171962969e-03
            5.072660078490497e-04
            -1.590524385900891e-04
            4.518535187218441e-05
            -1.150552941189881e-05
            2.595051534601611e-06
            -5.114445590060318e-07
            8.662986851312044e-08
            -1.234695127667996e-08
            1.439091024781492e-09
            -1.316547344608583e-10
            8.862077693625641e-12
            -3.901475667559581e-13
            8.425603428484139e-15];
end